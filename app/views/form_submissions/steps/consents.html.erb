<%= render layout: 'form_submissions/form', locals: { step_title: 'Required Consents' } do |form| %>
  <div class="space-y-4">
    <p class="text-sm text-muted-foreground">Please review and provide consent for the following items as required:</p>
    
    <% if @requirements.consents_required?('driver_license') %>
      <%= render_card title: "Driver's License Verification Consent", class: "mb-4" do %>
        <p class="text-sm text-muted-foreground mb-4">I consent to the verification of my driver's license information as part of this application process.</p>
        <div class="flex items-start space-x-2">
          <%= form.check_box :driver_license_consent,
                            class: 'h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary',
                            required: true,
                            checked: @form_submission.step_values(@step_id)['driver_license_consent'],
                            data: { form_target: 'field' } %>
          <%= form.label :driver_license_consent, 'I consent',
                        class: 'text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70' %>
        </div>
      <% end %>
    <% end %>
    
    <% if @requirements.consents_required?('drug_test') %>
      <%= render_card title: "Drug Test Consent", class: "mb-4" do %>
        <p class="text-sm text-muted-foreground mb-4">I consent to undergo drug testing as part of this application process.</p>
        <div class="flex items-start space-x-2">
          <%= form.check_box :drug_test_consent,
                            class: 'h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary',
                            required: true,
                            checked: @form_submission.step_values(@step_id)['drug_test_consent'],
                            data: { form_target: 'field' } %>
          <%= form.label :drug_test_consent, 'I consent',
                        class: 'text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70' %>
        </div>
      <% end %>
    <% end %>
    
    <% if @requirements.consents_required?('biometric') %>
      <%= render_card title: "Biometric Data Consent", class: "mb-4" do %>
        <p class="text-sm text-muted-foreground mb-4">I consent to the collection and processing of my biometric data as part of this application process.</p>
        <div class="flex items-start space-x-2">
          <%= form.check_box :biometric_consent,
                            class: 'h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary',
                            required: true,
                            checked: @form_submission.step_values(@step_id)['biometric_consent'],
                            data: { form_target: 'field' } %>
          <%= form.label :biometric_consent, 'I consent',
                        class: 'text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70' %>
        </div>
      <% end %>
    <% end %>
    
    <% if !@requirements.consents_required?('driver_license') &&
          !@requirements.consents_required?('drug_test') &&
          !@requirements.consents_required?('biometric') %>
      <div class="bg-blue-50 border-l-4 border-blue-400 p-4 rounded">
        <p class="text-sm text-blue-700">No consents are required for this application.</p>
      </div>
    <% end %>
  </div>
  
  <div data-form-target="navigation" class="flex justify-between mt-6">
    <!-- Navigation buttons will be dynamically rendered here by the FormController -->
  </div>
  
  <div class="flex justify-end mt-6">
    <%= render_button 'Next', as: :submit, name: 'commit', value: 'Next' %>
  </div>
<% end %>